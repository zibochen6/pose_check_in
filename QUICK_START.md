# 快速启动指南

## 1. 安装依赖（仅首次）

在 `punch` conda 环境中安装依赖：

```bash
conda activate punch
pip install rembg
```

## 2. 设置DISPLAY环境变量

```bash
export DISPLAY=:0
```

## 3. 运行程序

```bash
python pose.py
```

## 4. 使用流程

### 步骤1：进入检测区域
- 站在屏幕上显示的**黄色矩形框**内
- 状态显示：`Status: Person detected, get ready!`
- 右上角图标从**红色**变为**黄色**

### 步骤2：摆好姿势并保持
- 摆好你想要的姿势
- **保持不动3秒**
- 屏幕会显示倒计时：`Hold pose: 2.5s`
- 右上角图标渐变从黄色变为**绿色**

### 步骤3：等待生成
- 拍照完成后，画面会**模糊**
- 显示**旋转圆圈**动画
- 提示：`Generating your avatar, Please wait...`
- 这个过程大约需要**5-10秒**

### 步骤4：查看结果（单窗口 640x480）
- 生成完成后，画面自动切换为**结果展示**
- **窗口大小不变**（保持640x480，与摄像头一致）
- **顶部**：标题 "AI Anime Style - Success!"
- **中间**：生成的动漫风格图片（自动缩放并居中）
- **底部**：提示 "Complete! Leave area to reset"
- **特点**：切换流畅，无突兀感

### 步骤5：重置系统
- **离开检测区域**（走出黄色框）
- 系统自动重置，回到摄像头画面
- 可以开始下一次打卡

## 5. 退出程序

按 `q` 键退出

## 6. 查看生成的图片

打卡成功后，图片保存在 `punch_photos/` 目录：

```bash
ls -lh punch_photos/
```

每次打卡会生成两个文件：
- `punch_20251028_HHMMSS_bg_removed.png` - 去背景图（透明PNG）
- `punch_20251028_HHMMSS.jpg` - AI动漫风格图

## 故障排除

### 问题1：OpenCV无法显示窗口
```bash
export DISPLAY=:0
```

### 问题2：摄像头打不开
检查 `config.py` 中的 `camera_index`，尝试改为 `0` 或 `1`

### 问题3：YOLO模型加载失败
确保 `models/yolo11m-pose.engine` 文件存在

### 问题4：生成失败
检查网络连接和API密钥是否有效

### 问题5：语法错误
确保已更新到最新版本的 `pose.py`

## 性能提示

- 推荐在**光线良好**的环境下使用
- 保持**摄像头稳定**，避免抖动
- 姿势要**清晰可见**，避免遮挡
- 单人使用，避免多人同时在检测区域

## UI说明

### 摄像头模式（正常打卡）
- 实时摄像头画面
- 黄色检测框
- 左上角：状态文字
- 右上角：状态图标（红→黄→绿）

### 加载模式（生成中）
- 模糊背景
- 旋转圆圈动画
- 生成提示文字

### 结果模式（完成）- 单窗口 640x480
- 顶部：渐变标题栏（60px）
- 中间：生成的动漫图片（自动缩放居中，340px）
- 底部：渐变提示框（80px）
- **窗口大小与摄像头保持一致，切换流畅**
- **不再分左右对比，只显示最终结果**

## 特别说明

### 固定窗口大小设计
- 窗口大小始终保持 **640x480**（与摄像头一致）
- 摄像头、加载动画、结果展示全部使用相同窗口大小
- 切换过程流畅自然，无突兀感
- 只显示最终生成的动漫风格图片
- 去背景的原始图片会保存到文件，但不在屏幕上显示

### 自动缩放和居中
- 生成的图片自动缩放以适应 640x340 显示区域
- 保持宽高比，确保图片不变形
- 图片自动居中显示，多余空间用黑色填充
- 标题栏（60px）+ 图片区（340px）+ 提示框（80px）= 480px
